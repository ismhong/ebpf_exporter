programs:
  - name: cachestat
    metrics:
      counters:
        - name: page_cache_ops_total
          help: Page cache operation counters by type
          table: counts
          labels:
            - name: op
              size: 8
              decoders:
                - name: ksym
            - name: command
              size: 128
              decoders:
                - name: string
                - name: regexp
                  regexps:
                    - ^systemd-journal$
                    - ^syslog-ng$
    kprobes:
      add_to_page_cache_lru: add_to_page_cache_lru
      mark_page_accessed: mark_page_accessed
      account_page_dirtied: account_page_dirtied
      mark_buffer_dirty: mark_buffer_dirty
    elf: cachestat-complex.elf
